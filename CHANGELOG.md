
### v1.11.0 от 25 июня 2018 
Реорганизован классификатор источников финансирования договоров.
Добавлены отчёты приходах финансовых средств по договорам, ответственным, подразделениям

### v1.10.0 от 19 июня 2018 
В отчётах добавлена возможность фильтра данных по источнику финансирования договоров.

### v1.9.9 от 8 июня 2018 
Добавлена функция сверки сумм расхода итого по договорам и кодам КОСГУ исходной базы данных в сравнении с рассчётными значениями в хранилище сайта - кнопка "Сверка расхода" в кабинете администратора.

### v1.9.8 от 6 июня 2018 г.
В момент импорта данных расчет для каждого договора и КОСГУ содержимого следующих граф:

*Отчётная форма Смета, Вариант: План*
- Затраты с планом
- Остаток по смете
- Кассовые затраты

*Отчётная форма Смета, Вариант: Факт*
- Кассовые затраты
- Остаток денеж. средств

Расчёт итоговых сумм расходов, а также остатков средств, в разрезе по договорам и кодам КОСГУ, на сайте в момент нажатия на кнопку "Иморт данных" по следующему правилу:

1. Из файла Inet_MURashodLS расчёт итого по полю "Сумма" в разрезе по договорам и кодам КОСГУ, результат пишется в поле "Затраты_с_обяз" ("Затраты с планом") файла Inet_MUSmetaLSAll.
2. Из файла Inet_MURashodFaktLS расчёт итого по полю "Сумма" по договорам и кодам КОСГУ, результат пишется в поле "Затраты_факт" ("Кассовые затраты") файла Inet_MUSmetaLSAll.
3. В каждой записи файла Inet_MUSmetaLSAll расчёт:
- "Остаток_по_смете" ("Остаток по смете") = "Вх_Остаток" ("Ост. на начало") + "Сумма_назначения" ("Плановая сумма на год") - "Затраты_с_обяз" ("Затраты с планом") 
- "Остаток_ден" ("Остаток денеж. средств") = "Вх_Остаток" ("Ост. на начало") + "Доход_по_статье" ("Поступление денеж срв.") - "Затраты_факт" ("Кассовые затраты")

### v1.9.7 от 29 мая 2018 г.
Используется файл `Inet_MURashodFaktLS` при выводе записей расхода по варианту `Факт` 

### v1.9.4 от 25 мая 2018 г.
Добавлена возможность сменить пароль у администратора. 

### v1.9.3 от 22 мая 2018 г.
Добавлена возможность работы по веб-протоколу HTTPS. 
По умолчанию сервер работает по протоколу HTTP. 
Для работы по протоколу HTTPS необходимо в `config_local.js` добавить пару

`"ssl": 1`

и положить в папку `./bin/` ключ и сертификат, а именно файлы `key.pem` и `cert.pem`.
Указанные местоположение и наименования файлов применяется по умолчанию, 
иначе следует указать путь к ключу и сертификату в `config_local.js` следующим образом
```
    "ssl": 1,
    "sslKey": "./bin/key.pem",
    "sslCert": "./bin/cert.pem"
```
При указании `"ssl": 0` работа без шифрования, по HTTP.

### v1.9.2 от 21 мая 2018 
Руководителю подразделения необходимо выдавать информацию в рамках его сферы ответственности.
К сожалению в базе данных отсутствуют сведения кто каким подразделением руководит.
Поэтому администатору предоставлена возможность указывать кто является руководителем какого подразделения.

У администратора есть три (навигационных) кнопки:
- `"Экономисты"` - здесь можно добавить/редактировать/удалить пользователя с 'ролью' "экономист", с правом полного доступа к информации на сайте.
- `"Руководители"`, тут список ответственных исполнителей договоров из базы данных - здесь можно предоставить/убрать пароль пользователя сайта (у них 'роль' "мастер").
- `"Подразделения"`, тут представлена организационная структура из базы данных - администратор здесь может указать кто из руководителей является начальником какого подразделения.

Итак, 
- Пользователям с ролью "экономист" предоставляется доступ ко всей информации, без ограничений.
- Руководителю договора обеспечен доступ только к своим договорам;
- Руководителю подразделения обеспечен доступ ко всем договорам непосредственно своего подразделения и подразделений ниже по подчинённости.

###  v1.9.0 от 17 мая 2018 г.
Требование Козловской И.А.
> 1. Должен быть доступ ко всем счетам ей и ректору, 
> 1. Каждому руководителю ЛС доступ только к своим записям,
> 1. Руководителю подразделения доступ к записям всех ЛС данного подразделения.
> 1. Администратор для работы с базой пользователей.

В момент первоначального импорта данных будут созданы записи пользователей:

- один пользователь с правами администратора (право давать пароли пользователям - руководителям)
login/password: `admin / admin`
- два пользователя с правами экономиста (право получать всю финансовую информацию)
login/password: `booker / booker` и `rector / rector`

###  v1.8.3 от 27 апреля 2018 г.
Исправлена ошибка: отчёт расхода вывод Итого не обнуляется после выбора месяца в случае когда нет записей расхода.

###  v1.8.2
В отчёте записей расхода суммы выводятся без округления, с точностью до копейки.

###  v1.8.1 от 26 апреля 2018 г.
Добавлена возможность выбора месяца в отчётной форме расходных записей.

###  v1.8.0 от 25 апреля 2018 г.
Добавлены отчётные формы по расходным записям согласно служебной записке товарища Куприяновой от 23 апреля 2018:
> 1. Я поменяла имя выгрузки по смете: вместо Inet_SmetaLSAll теперь называется Inet_MUSmetaLSAll. Я вообще в дальнейшем спец. выгрузки для ИА буду помечать Inet_MU.
> 1. Сделала выгрузку для расходов. Inet_MURashodLS.txt. Описывать поля не буду, там  все ясно из файла Excel "Затраты для интернета" (вложение).
>
> Задача такая:
>
> 1. На вкладке расходы выводить все расходы соответственно для лс/подразделения/руководителя в формате , как в файле excel, т.е. с группировкой и пром итогом по КОСГУ.
> 1. При щелчке на поле КОСГУ в отчете смета  выводить часть списка затрат по соответствующему КОСГУ   соответственно для лс/подразделения/руководителя .
> 1. Во всех отчетах по расходу предусмотреть для пользователя возможность выбора периода. 

###  v1.7.1 от 19 апреля 2018 г.
- Добавлены вкладки Доходы и Расходы для  Руководителя и для Подразделения ( как для Лицевого счета)
- Строка заголовков таблицы фиксируется наверху экрана при прокрутке.
- Строка Итоги таблицы фиксируется внизу экрана при прокрутке.

### 9 апреля 2018 г.
От: Куприянова Татьяна Борисовна
> 1. Заменить название Классификация операций сектора государственного управления на КОСГУ.
> 1. Убрать варианты отчетов: Вариант1, План, Финансы
> 1. На вкладке Подразделения+Договоры (договоры везде заменить на лицевые счета) при щелчке на узле подразделения должна выводиться смета по подразделению(группировка смет его лицевых счетов по данному подразделению), а не список лицевых счетов с отчетом по ним.
> 1. Тоже самое про вкладку Отв+Договоры - при щелчке на Руководителе выводить смету по Руководителю (группировка смет его лицевых счетов по виду деятельности), а не отчет по его лицевым счетам.
> 1. В головной смете по виду деятельности не выводится Итого
> 1. Вкладка Отв+Договоры внизу(или вверху, где удобнее вывести общую сумму итога по колонкам)
>
>Повторюсь по вкладками:
> - Убрать вкладки Подразделения,Договоры, Ответственные.
> - Оставить: Подр+Договоры, Отв+Договоры

### v1.6.1 от 6 апреля 2018 г.
- Учётные данные разделены по направлениям деятельности - основной и научной,
- Изменён формат отчётных форм
в соответствии с требованием Заказчика:
> 1. Inet_PolzNew.txt - наш старый файл доступа к лицевым счетам по ФИО. 
> Поле ЛицевойСчет (второе в выгрузке) интерпретируем теперь не как Лицевой счет, а как фамилию руководителя Лицевого счета.
> 1. Файл Inet_SmetaSAll.txt  содержит все сметы по лицевым счетам, руководителям лс и подразделениям. Описываю его структуру (добавила 1 поле) с соглсованными названиями полей.
>     1. Поле Руководитель -это руководитель лицевого счета (если в файле .Inet_PolzNew.txt он доступен данному пользователю, то раскрываем для него данные по всем лицевым счетам, где стоит этот руководитель).
>     1.  лицевой_счет- Лицевой счет
>     1. код_факультета - код факультета, к которому принадлежит ЛС
>     1. кр_название - кр.название факультета
>     1. код_кафедры - код кафедры, к которой относится лицевой счет
>     1. кр_кафедра - ее краткое название
>     1. Сокр_код - код сметы
>     1.  Название_статьи - название статьи сметы
>     1. Процент-  процент по смете для лицевого счета
>     1. Тип_договора- тип лицевого счета
>     1. Вх_Остаток - Остаток на начало
>     1. Сумма_назначения - Плановая сумма на год
>     1. Доход_по_статье - Поступление денеж ср-в.
>     1. Затраты_с_обяз -Затраты с планом
>     1. Затраты_факт - Кассовые затраты
>     1. Остаток_ден -Остаток денеж. средств
>     1. Остаток_по_смете - Остаток по смете
>     1. Остаток_смета_БО - Остаток по смете без учета обязательств
>
>  При попадании в систему первая страница должна содержать два входа :
> 1. Основная деятельность.
> 2. Наука.
> 
> в п.1 попадают сведения по всем все ЛС, у которых поле тип_договора не содержит слово "Наука".
> в п.2 попадают сведения по всем все ЛС, у которых поле тип_договора содержит слово "Наука".
> 
> Далее идут Вкладки по каждому блоку:
> 1. Подразделения -см. вложение "пример первой страницы"
> 2. Руководители  см вложение - "Пример руководители"
> 
> п.1 д.выглядеть как в файле Пример_ПервойСтраницы.xlsx - доступные для пользователя счета выводятся в рамках структуры подразделений (т.е. исходя из порядковых номеров подразделений)  поля 2.10-2.7 суммируются по лицевым счетам).
> 
> Далее, при щелчке по номеру лицевого счета выводится его смета, как в файле Исполнение сметы на 02042018-1 . Выводим по умолчанию первый вариант сметы и наверху кнопка - выбрать вариант, чтобы пользователь мог переключать варианты сметы.

###  v1.5.1 от 4 апреля 2018 г.
добавлена возможность переключать варианты формы отчета:
- "Вариант 1" и "Вариант 2" согласно письму ИА от 02.04.2018 ,
- "Вар. План" и "Вар. Финансы" согласно моим предложениям от 02.04.2018.

Соответственно добавлен пункт меню "Вариант..."

Согласно требованию Козловской И.А. от 2 апреля 2018 г.
> - Существуют 2 варианта сметы - для науки и для образ.деятельности. Пользователь может переключать варианты отчета по кнопке вверху страницы. Обратите внимание на заголовки полей.

### v1.4.0 от 26 марта 2018 г.
В данной версии программы не используется значение "mongoDB" из `config_local.js`, потому что тут понадобилось отдельно указывать `host` и `dbName`.
То есть параметр `"mongoDB"` заменены на два параметра:
```
"dbUrl":  "mongodb://127.0.0.1:27017",
"dbName": "edu",
```
Эти значения используются программой по умолчанию, то есть программа по умолчанию обращается за данными к локальной машине через порт `"27017"` в базу данных `"edu"`. Если вдруг когда потребуется другие значения, надо будет указать их в `config_local.js`, в качестве образца смотри `config_local.js.origin`

Согласно требованиям Куприяновой Т.Б., служебная записка от 23 марта 2018 г.:

> Попробуем начать создавать очередной сайт для ИА. Работаем пока с двумя файлами во вложении.
> * Inet_PolzNew.txt - наш старый файл доступа к лицевым счетам по ФИО.
Только поле ЛицевойСчет (второе в выгрузке) интерпретируем теперь не как Лицевой счет, а как фамилию руководителя Лицевого счета.
> * Файл Inet_SmetaSAll.txt  содержит все сметы по лицевым счетам, руководителям лс и подразделениям. Описываю его структуру:
> 1. Поле Руководитель -это руководитель лицевого счета (если в файле .Inet_PolzNew.txt он доступен данному пользователю, то раскрываем для него данные по всем лицевым счетам, где стоит этот руководитель).
> 1.  лицевой_счет- Лицевой счет 
> 1. код_факультета - код факультета, к которому принадлежит ЛС
> 1. кр_название - кр.название факультета
> 1. код_кафедры - код кафедры, к которой относится лицевой счет
> 1. кр_кафедра - ее краткое название
> 1. Сокр_код - код сметы
> 1.  Название_статьи - название статьи сметы
> 1. Процент-  процент по смете для лицевого счета
> 1. Вх_Остаток - Нач остаток
> 1. Сумма_назначения - Сметные назначения
> 1. Доход_по_статье - Приход
> 1. Затраты_с_обяз - Расход с обяз
> 1. Затраты_факт - Расход фактический
> 1. Остаток_ден -Остаток фактический
> 1. Остаток_по_смете - Остаток по смете
> 1. Остаток_смета_БО - Остаток по смете без учета обязательств
>
> При попадании в систему первая страница должна выглядеть как в файле Пример_ПервойСтраницы.xlsx - доступные для пользователя счета выводятся в рамках структуры подразделений (т.е. исходя из порядковых номеров подразделений)  поля 2.10-2.17 суммируются по лицевым счетам). Далее, при щелчке по номеру лицевого счета выводится его смета, как в файле Пример_Сметы.xlsx. Попробуйте для начала сделать это, покажем ИА. Она может поменять поля или названия. Когда это утрясем, перейдем к получению сгруппированной смете по фамилии Руководителя или по Подразделению.

-----------------
